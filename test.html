<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Extension Architecture Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .controls {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-section {
            padding: 20px;
            background: white;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        
        .test-card {
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .test-card.success {
            border-left: 5px solid #28a745;
        }
        
        .test-card.failed {
            border-left: 5px solid #dc3545;
        }
        
        .test-card.pending {
            border-left: 5px solid #ffc107;
        }
        
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .test-name {
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .test-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
        }
        
        .status-failed {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .test-details {
            font-size: 0.9em;
            color: #6c757d;
        }
        
        .combo-chain {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.9em;
        }
        
        .current-test {
            padding: 20px;
            background: #e7f3ff;
            border-radius: 10px;
            margin: 20px;
            border-left: 5px solid #007bff;
        }
        
        .logs-container {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-timestamp {
            color: #6a9955;
        }
        
        .log-info {
            color: #9cdcfe;
        }
        
        .log-success {
            color: #4ec9b0;
        }
        
        .log-error {
            color: #f44747;
        }
        
        .log-warning {
            color: #cca700;
        }
        
        .summary {
            padding: 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            text-align: center;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .stat-success {
            color: #28a745;
        }
        
        .stat-failed {
            color: #dc3545;
        }
        
        .stat-pending {
            color: #ffc107;
        }
        
        .recommendations {
            text-align: left;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .recommendation-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .cleanup-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            margin: 20px;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ Universal Extension Architecture Test</h1>
            <div class="subtitle">–ü–æ–ª–Ω–æ–µ –∫–∞—Å–∫–∞–¥–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π</div>
        </div>
        
        <div class="controls">
            <button id="startTest" class="btn btn-primary">
                <span class="spinner hidden"></span>
                üöÄ –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
            </button>
            <button id="stopTest" class="btn btn-secondary" disabled>‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
            <button id="reloadPage" class="btn btn-danger">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
            <button id="exportResults" class="btn btn-secondary" disabled>üìä –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</button>
            <div style="margin-left: auto; font-weight: 600;">
                –ö–æ–Ω—Ç–µ–∫—Å—Ç: <span id="contextInfo">–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...</span>
            </div>
        </div>
        
        <div id="cleanupNotice" class="cleanup-notice hidden">
            <strong>‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:</strong> –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        </div>
        
        <div id="progressSection" class="progress-section hidden">
            <div class="progress-info">
                <span>–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: <span id="overallProgress">0%</span></span>
                <span>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: <span id="elapsedTime">00:00</span></span>
                <span>–û—Å—Ç–∞–ª–æ—Å—å: <span id="remainingTime">--:--</span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div id="currentTest" class="current-test hidden">
                <strong>–¢–µ–∫—É—â–∏–π —Ç–µ—Å—Ç:</strong> <span id="currentTestName">-</span>
                <div class="combo-chain" id="comboChain"></div>
            </div>
        </div>
        
        <div class="results-grid" id="resultsGrid">
            <!-- –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
        
        <div class="logs-container" id="logsContainer">
            <div class="log-entry"><span class="log-timestamp">[00:00:00]</span> <span class="log-info">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</span></div>
        </div>
        
        <div id="summarySection" class="summary hidden">
            <h2>üéâ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h2>
            <div class="stats" id="statsContainer">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="recommendations" id="recommendationsContainer">
                <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>

    <script>
        class CascadedExtensionArchitectureTest {
            constructor() {
                this.results = new Map();
                this.testQueue = [];
                this.isTesting = false;
                this.startTime = null;
                this.currentTestIndex = 0;
                this.totalTests = 0;
                this.createdElements = new Set();
                
                // –£–í–ï–õ–ò–ß–ï–ù–ù–´–ï –ó–ê–î–ï–†–ñ–ö–ò –î–õ–Ø –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
                this.delays = {
                    LIGHT: 2000, // 2 —Å–µ–∫—É–Ω–¥—ã
                    ELEMENT_CREATION: 5000, // 5 —Å–µ–∫—É–Ω–¥
                    ARCHITECTURE_SWITCH: 10000, // 10 —Å–µ–∫—É–Ω–¥
                    HEAVY_OPERATION: 4000, // 4 —Å–µ–∫—É–Ω–¥—ã
                    BLOCKING_RECOVERY: 15000 // 15 —Å–µ–∫—É–Ω–¥
                };
                
                // –í–°–ï –ê–†–•–ò–¢–ï–ö–¢–£–†–´ –ò–ó –ü–ï–†–í–û–ì–û –°–û–û–ë–©–ï–ù–ò–Ø
                this.architectures = [
                    'iframe-basic', 'iframe-srcdoc', 'shadow-dom-open',
                    'shadow-dom-closed', 'content-script-direct',
                    'popup-overlay-hybrid', 'modal-iframe-hybrid',
                    'micro-frontend-modular', 'floating-window'
                ];
                
                // –í–°–ï –°–ü–û–°–û–ë–´ –ú–û–î–£–õ–¨–ù–û–°–¢–ò
                this.modularityMethods = [
                    'eval-direct', 'new-function', 'script-tag-src',
                    'script-tag-inline', 'import-dynamic', 'blob-url',
                    'data-url', 'iframe-comms', 'postmessage-modules',
                    'storage-modules', 'worker-modules', 'wasm-modules'
                ];
                
                // –í–°–ï –ú–ï–¢–û–î–´ –ö–û–ú–ú–£–ù–ò–ö–ê–¶–ò–ò
                this.communicationMethods = [
                    'window-postmessage', 'broadcast-channel', 'shared-worker',
                    'service-worker', 'local-storage-events', 'indexed-db',
                    'message-channel', 'custom-events'
                ];
                
                // –í–°–ï –¢–ï–°–¢–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
                this.securityTests = [
                    'csp-detection', 'xss-vulnerability', 'data-isolation',
                    'permission-check', 'secure-messaging', 'resource-loading'
                ];
                
                this.initUI();
                this.detectContext();
            }
            
            initUI() {
                this.startButton = document.getElementById('startTest');
                this.stopButton = document.getElementById('stopTest');
                this.reloadButton = document.getElementById('reloadPage');
                this.exportButton = document.getElementById('exportResults');
                this.progressSection = document.getElementById('progressSection');
                this.currentTestElement = document.getElementById('currentTest');
                this.resultsGrid = document.getElementById('resultsGrid');
                this.logsContainer = document.getElementById('logsContainer');
                this.summarySection = document.getElementById('summarySection');
                this.cleanupNotice = document.getElementById('cleanupNotice');
                
                this.startButton.addEventListener('click', () => this.startTesting());
                this.stopButton.addEventListener('click', () => this.stopTesting());
                this.reloadButton.addEventListener('click', () => this.reloadPage());
                this.exportButton.addEventListener('click', () => this.exportResults());
            }
            
            detectContext() {
                let context = 'unknown';
                if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.id) {
                    context = window === window.top ? 'content-script' : 'iframe-slider';
                } else if (window.self !== window.top) {
                    context = 'website-iframe';
                } else {
                    context = 'website-main';
                }
                
                document.getElementById('contextInfo').textContent = context;
                this.currentContext = context;
                this.log(`–ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω: ${context}`, 'info');
            }
            
            async startTesting() {
                if (this.isTesting) return;
                
                this.isTesting = true;
                this.startTime = Date.now();
                this.currentTestIndex = 0;
                this.results.clear();
                this.testQueue = [];
                this.createdElements.clear();
                
                this.startButton.disabled = true;
                this.stopButton.disabled = false;
                this.reloadButton.disabled = true;
                this.startButton.querySelector('.spinner').classList.remove('hidden');
                this.progressSection.classList.remove('hidden');
                this.currentTestElement.classList.remove('hidden');
                this.summarySection.classList.add('hidden');
                this.cleanupNotice.classList.add('hidden');
                
                this.resultsGrid.innerHTML = '';
                this.logsContainer.innerHTML = '';
                
                this.log('üöÄ –ù–ê–ß–ò–ù–ê–ï–ú –ü–û–õ–ù–û–ï –ö–ê–°–ö–ê–î–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï', 'info');
                this.log(`üìä –¢–µ—Å—Ç–∏—Ä—É–µ–º ${this.architectures.length} –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä √ó ${this.modularityMethods.length} –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–µ–π √ó ${this.communicationMethods.length} –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π √ó ${this.securityTests.length} —Ç–µ—Å—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏`, 'info');
                this.log(`‚è±Ô∏è –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ–µ –≤—Ä–µ–º—è: 45-60 –º–∏–Ω—É—Ç`, 'warning');
                
                // –°—Ç—Ä–æ–∏–º –æ—á–µ—Ä–µ–¥—å —Ç–µ—Å—Ç–æ–≤
                await this.buildTestQueue();
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏
                await this.executeTestQueue();
            }
            
            async buildTestQueue() {
                this.log('üìã –§–æ—Ä–º–∏—Ä—É–µ–º –æ—á–µ—Ä–µ–¥—å —Ç–µ—Å—Ç–æ–≤...', 'info');
                
                let testCount = 0;
                for (const arch of this.architectures) {
                    for (const modularity of this.modularityMethods) {
                        for (const communication of this.communicationMethods) {
                            for (const security of this.securityTests) {
                                const testId = `${arch}-${modularity}-${communication}-${security}`;
                                this.testQueue.push({
                                    id: testId,
                                    arch,
                                    modularity, 
                                    communication,
                                    security,
                                    combo: `${arch} ‚Üí ${modularity} ‚Üí ${communication} ‚Üí ${security}`
                                });
                                testCount++;
                            }
                        }
                    }
                }
                
                this.totalTests = testCount;
                this.log(`‚úÖ –û—á–µ—Ä–µ–¥—å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞: ${this.totalTests} —Ç–µ—Å—Ç–æ–≤`, 'success');
            }
            
            async executeTestQueue() {
                this.log(`üéØ –ù–∞—á–∏–Ω–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ${this.totalTests} —Ç–µ—Å—Ç–æ–≤...`, 'info');
                
                for (let i = 0; i < this.testQueue.length; i++) {
                    if (!this.isTesting) break;
                    
                    this.currentTestIndex = i;
                    const test = this.testQueue[i];
                    
                    await this.executeSingleTest(test);
                    this.updateProgress();
                    
                    // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏
                    if (i < this.testQueue.length - 1) {
                        await this.delay(this.delays.LIGHT);
                    }
                }
                
                this.finishTesting();
            }
            
            async executeSingleTest(test) {
                this.updateCurrentTestDisplay(test);
                this.log(`üß™ –ó–∞–ø—É—Å–∫: ${test.combo}`, 'info');
                
                const testResult = {
                    id: test.id,
                    combo: test.combo,
                    startTime: new Date(),
                    status: 'pending',
                    details: {}
                };
                
                this.addTestCard(testResult);
                
                try {
                    // 1. –¢–µ—Å—Ç–∏—Ä—É–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
                    this.log(`   üèóÔ∏è  –°–æ–∑–¥–∞–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É: ${test.arch}`, 'info');
                    await this.delay(this.delays.ARCHITECTURE_SWITCH);
                    const archResult = await this.testArchitecture(test.arch);
                    testResult.details.architecture = archResult;
                    
                    if (!archResult.success) {
                        throw new Error(`–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ${test.arch} –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: ${archResult.error}`);
                    }
                    
                    // 2. –¢–µ—Å—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –≤ —ç—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
                    this.log(`   üîß –¢–µ—Å—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å: ${test.modularity}`, 'info');
                    await this.delay(this.delays.ELEMENT_CREATION);
                    const modularityResult = await this.testModularity(test.arch, test.modularity);
                    testResult.details.modularity = modularityResult;
                    
                    if (!modularityResult.success) {
                        throw new Error(`–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å ${test.modularity} –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: ${modularityResult.error}`);
                    }
                    
                    // 3. –¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é
                    this.log(`   üì° –¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é: ${test.communication}`, 'info');
                    await this.delay(this.delays.LIGHT);
                    const communicationResult = await this.testCommunication(test.arch, test.communication);
                    testResult.details.communication = communicationResult;
                    
                    if (!communicationResult.success) {
                        throw new Error(`–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è ${test.communication} –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: ${communicationResult.error}`);
                    }
                    
                    // 4. –¢–µ—Å—Ç–∏—Ä—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
                    this.log(`   üõ°Ô∏è  –¢–µ—Å—Ç–∏—Ä—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ${test.security}`, 'info');
                    await this.delay(this.delays.LIGHT);
                    const securityResult = await this.testSecurity(test.arch, test.security);
                    testResult.details.security = securityResult;
                    
                    testResult.status = 'success';
                    testResult.endTime = new Date();
                    testResult.duration = testResult.endTime - testResult.startTime;
                    
                    this.log(`‚úÖ –£–°–ü–ï–•: ${test.combo} (${testResult.duration}ms)`, 'success');
                    this.updateTestCard(testResult);
                    
                } catch (error) {
                    testResult.status = 'failed';
                    testResult.error = error.message;
                    testResult.endTime = new Date();
                    testResult.duration = testResult.endTime - testResult.startTime;
                    
                    this.log(`‚ùå –û–®–ò–ë–ö–ê: ${test.combo} - ${error.message}`, 'error');
                    this.updateTestCard(testResult);
                }
                
                this.results.set(test.id, testResult);
            }
            
            // –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –í–°–ï–• –ê–†–•–ò–¢–ï–ö–¢–£–† –ò–ó –ü–ï–†–í–û–ì–û –°–û–û–ë–©–ï–ù–ò–Ø
            async testArchitecture(architecture) {
                try {
                    switch (architecture) {
                        case 'iframe-basic':
                            return await this.createIframeBasic();
                        case 'iframe-srcdoc':
                            return await this.createIframeSrcdoc();
                        case 'shadow-dom-open':
                            return await this.createShadowDomOpen();
                        case 'shadow-dom-closed':
                            return await this.createShadowDomClosed();
                        case 'content-script-direct':
                            return await this.createContentScriptDirect();
                        case 'popup-overlay-hybrid':
                            return await this.createPopupOverlayHybrid();
                        case 'modal-iframe-hybrid':
                            return await this.createModalIframeHybrid();
                        case 'micro-frontend-modular':
                            return await this.createMicroFrontendModular();
                        case 'floating-window':
                            return await this.createFloatingWindow();
                        default:
                            throw new Error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: ${architecture}`);
                    }
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }
            
            async createIframeBasic() {
                const iframe = document.createElement('iframe');
                iframe.style.cssText = 'width:300px;height:200px;border:2px solid blue;position:fixed;top:10px;right:10px;z-index:10000';
                iframe.src = 'about:blank';
                document.body.appendChild(iframe);
                this.createdElements.add(iframe);
                return { success: true, type: 'iframe-basic', element: iframe };
            }
            
            async createIframeSrcdoc() {
                const iframe = document.createElement('iframe');
                iframe.style.cssText = 'width:300px;height:200px;border:2px solid green;position:fixed;top:50px;right:10px;z-index:10000';
                iframe.srcdoc = `
                    <!DOCTYPE html>
                    <html>
                    <head><title>Iframe Test</title></head>
                    <body>
                        <h3>Srcdoc Iframe</h3>
                        <script>window.IframeModule = { test: () => 'srcdoc_works' };</script>
                    </body>
                    </html>
                `;
                document.body.appendChild(iframe);
                this.createdElements.add(iframe);
                return { success: true, type: 'iframe-srcdoc', module: 'IframeModule' };
            }
            
            async createShadowDomOpen() {
                const host = document.createElement('div');
                host.style.cssText = 'position:fixed;top:100px;right:10px;z-index:10000';
                const shadow = host.attachShadow({ mode: 'open' });
                shadow.innerHTML = `
                    <style>
                        .shadow-test { 
                            width: 250px; height: 150px; background: #f0f8ff; 
                            border: 2px dashed #4682b4; padding: 15px; 
                            border-radius: 8px; 
                        }
                    </style>
                    <div class="shadow-test">
                        <h4>Shadow DOM Open</h4>
                        <p>Mode: open</p>
                    </div>
                `;
                document.body.appendChild(host);
                this.createdElements.add(host);
                window.ShadowOpenModule = { test: () => 'shadow_open_works' };
                return { success: true, type: 'shadow-dom-open', mode: 'open' };
            }
            
            async createShadowDomClosed() {
                try {
                    const host = document.createElement('div');
                    host.style.cssText = 'position:fixed;top:150px;right:10px;z-index:10000';
                    const shadow = host.attachShadow({ mode: 'closed' });
                    shadow.innerHTML = `
                        <div style="width: 200px; height: 120px; background: #fff0f5; 
                                    border: 2px solid #ff69b4; padding: 10px; border-radius: 6px;">
                            <h4>Shadow DOM Closed</h4>
                            <p>Mode: closed</p>
                        </div>
                    `;
                    document.body.appendChild(host);
                    this.createdElements.add(host);
                    return { success: true, type: 'shadow-dom-closed', mode: 'closed' };
                } catch (error) {
                    throw new Error(`Shadow DOM Closed: ${error.message}`);
                }
            }
            
            async createContentScriptDirect() {
                try {
                    const slider = document.createElement('div');
                    slider.id = 'content-script-slider';
                    slider.style.cssText = `
                        position: fixed; top: 200px; right: 10px; width: 280px; height: 180px;
                        background: white; z-index: 10000; padding: 15px; border: 2px solid #32cd32;
                        border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    `;
                    slider.innerHTML = `
                        <h4>Content Script Direct</h4>
                        <p>–ü—Ä—è–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DOM —Å–∞–π—Ç–∞</p>
                    `;
                    document.body.appendChild(slider);
                    this.createdElements.add(slider);
                    window.ContentScriptModule = { test: () => 'content_script_works' };
                    return { success: true, type: 'content-script-direct', integration: 'direct-dom' };
                } catch (error) {
                    throw new Error(`Content Script Direct: ${error.message}`);
                }
            }
            
            async createPopupOverlayHybrid() {
                try {
                    const overlay = document.createElement('div');
                    overlay.style.cssText = `
                        position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
                        background: rgba(0,0,0,0.4); z-index: 9998; display: none;
                    `;
                    
                    const popup = document.createElement('div');
                    popup.style.cssText = `
                        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                        width: 320px; height: 240px; background: white; z-index: 9999;
                        padding: 20px; border-radius: 12px; box-shadow: 0 8px 30px rgba(0,0,0,0.3);
                        display: none;
                    `;
                    popup.innerHTML = `
                        <h4>Popup+Overlay Hybrid</h4>
                        <p>–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</p>
                        <button onclick="window.HybridModule.hide()">–ó–∞–∫—Ä—ã—Ç—å</button>
                    `;
                    
                    document.body.appendChild(overlay);
                    document.body.appendChild(popup);
                    this.createdElements.add(overlay);
                    this.createdElements.add(popup);
                    
                    window.HybridModule = {
                        show: () => {
                            overlay.style.display = 'block';
                            popup.style.display = 'block';
                            return 'hybrid_shown';
                        },
                        hide: () => {
                            overlay.style.display = 'none';
                            popup.style.display = 'none';
                            return 'hybrid_hidden';
                        }
                    };
                    
                    HybridModule.show();
                    
                    return { 
                        success: true, 
                        type: 'popup-overlay-hybrid', 
                        components: ['overlay', 'popup'],
                        module: 'HybridModule'
                    };
                } catch (error) {
                    throw new Error(`Popup+Overlay Hybrid: ${error.message}`);
                }
            }
            
            async createModalIframeHybrid() {
                try {
                    const modal = document.createElement('div');
                    modal.style.cssText = `
                        position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
                        background: rgba(0,0,0,0.6); z-index: 10000; display: flex;
                        align-items: center; justify-content: center; display: none;
                    `;
                    
                    const iframe = document.createElement('iframe');
                    iframe.style.cssText = `
                        width: 80vw; max-width: 600px; height: 80vh; border: none; 
                        border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.4);
                    `;
                    iframe.srcdoc = `
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <style>
                                body { 
                                    margin: 0; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                    color: white; font-family: Arial, sans-serif;
                                }
                                h2 { margin-top: 0; }
                            </style>
                        </head>
                        <body>
                            <h2>Modal+Iframe Hybrid</h2>
                            <p>–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π iframe –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞</p>
                            <p>–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏–π</p>
                        </body>
                        </html>
                    `;
                    
                    modal.appendChild(iframe);
                    document.body.appendChild(modal);
                    this.createdElements.add(modal);
                    
                    window.ModalIframeModule = {
                        show: () => { modal.style.display = 'flex'; return 'modal_shown'; },
                        hide: () => { modal.style.display = 'none'; return 'modal_hidden'; }
                    };
                    
                    return { 
                        success: true, 
                        type: 'modal-iframe-hybrid', 
                        architecture: 'modal-container + iframe-content',
                        module: 'ModalIframeModule'
                    };
                } catch (error) {
                    throw new Error(`Modal+Iframe Hybrid: ${error.message}`);
                }
            }
            
            async createMicroFrontendModular() {
                try {
                    const container = document.createElement('div');
                    container.id = 'microfrontend-container';
                    container.style.cssText = `
                        position: fixed; top: 250px; right: 10px; width: 350px; height: 220px;
                        background: white; z-index: 10000; padding: 20px;
                        border: 2px solid #ff8c00; border-radius: 10px;
                        box-shadow: 0 6px 20px rgba(0,0,0,0.2); display: flex;
                        flex-direction: column; gap: 15px;
                    `;
                    
                    const header = document.createElement('div');
                    header.innerHTML = '<h4 style="margin:0;color:#ff8c00;">Micro-Frontend System</h4>';
                    header.style.cssText = 'border-bottom: 1px solid #eee; padding-bottom: 10px;';
                    
                    const content = document.createElement('div');
                    content.id = 'microfrontend-content';
                    content.style.cssText = 'flex: 1; overflow-y: auto; padding: 10px; background: #f9f9f9; border-radius: 6px;';
                    content.innerHTML = '<p style="margin:0;color:#666;">–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –º–æ–¥—É–ª–∏</p>';
                    
                    const footer = document.createElement('div');
                    footer.style.cssText = 'display: flex; gap: 10px;';
                    footer.innerHTML = `
                        <button style="padding:8px 12px;background:#ff8c00;color:white;border:none;border-radius:4px;cursor:pointer;"
                                onclick="MicroFrontendSystem.loadModule('export')">Export Module</button>
                        <button style="padding:8px 12px;background:#32cd32;color:white;border:none;border-radius:4px;cursor:pointer;"
                                onclick="MicroFrontendSystem.loadModule('sync')">Sync Module</button>
                    `;
                    
                    container.appendChild(header);
                    container.appendChild(content);
                    container.appendChild(footer);
                    document.body.appendChild(container);
                    this.createdElements.add(container);
                    
                    window.MicroFrontendSystem = {
                        modules: new Map(),
                        
                        registerModule: function(name, moduleConfig) {
                            this.modules.set(name, {
                                ...moduleConfig,
                                loaded: false
                            });
                        },
                        
                        loadModule: function(name) {
                            const module = this.modules.get(name);
                            if (module) {
                                content.innerHTML = `
                                    <div style="background:white;padding:15px;border-radius:6px;border-left:4px solid #ff8c00;">
                                        <h5 style="margin:0 0 10px 0;">–ú–æ–¥—É–ª—å: ${name}</h5>
                                        <p style="margin:0;color:#333;">${module.description || '–ú–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω'}</p>
                                    </div>
                                `;
                                module.loaded = true;
                                return `module_${name}_loaded`;
                            }
                            return `module_${name}_not_found`;
                        }
                    };
                    
                    MicroFrontendSystem.registerModule('export', {
                        name: 'Export Module',
                        description: '–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã',
                        version: '1.0'
                    });
                    
                    MicroFrontendSystem.registerModule('sync', {
                        name: 'Sync Module', 
                        description: '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –æ–±–ª–∞—á–Ω—ã–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏',
                        version: '1.0'
                    });
                    
                    return {
                        success: true,
                        type: 'micro-frontend-modular',
                        components: ['header', 'content', 'footer'],
                        system: 'MicroFrontendSystem',
                        modules: Array.from(MicroFrontendSystem.modules.keys())
                    };
                } catch (error) {
                    throw new Error(`Micro-Frontend Modular: ${error.message}`);
                }
            }
            
            async createFloatingWindow() {
                try {
                    const floatingWindow = document.createElement('div');
                    floatingWindow.style.cssText = `
                        position: fixed; bottom: 20px; right: 20px; width: 300px; 
                        background: white; z-index: 10000; padding: 15px;
                        border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.2);
                        border: 2px solid #9370db; cursor: move;
                        resize: both; overflow: auto; min-height: 150px; min-width: 250px;
                    `;
                    
                    floatingWindow.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 8px;">
                            <h5 style="margin:0;color:#9370db;">Floating Window</h5>
                            <button onclick="this.parentElement.parentElement.style.display='none'" 
                                    style="background:none;border:none;font-size:16px;cursor:pointer;color:#666;">√ó</button>
                        </div>
                        <div style="font-size:14px;color:#333;">
                            <p>üöÄ –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º–æ–µ –æ–∫–Ω–æ</p>
                            <p>üìê –ò–∑–º–µ–Ω—è–µ–º—ã–π —Ä–∞–∑–º–µ—Ä</p>
                            <p>üéØ –ü–ª–∞–≤–∞—é—â–∏–π —Ä–µ–∂–∏–º</p>
                        </div>
                    `;
                    
                    this.makeDraggable(floatingWindow);
                    document.body.appendChild(floatingWindow);
                    this.createdElements.add(floatingWindow);
                    
                    window.FloatingWindowModule = {
                        show: () => { floatingWindow.style.display = 'block'; return 'floating_shown'; },
                        hide: () => { floatingWindow.style.display = 'none'; return 'floating_hidden'; }
                    };
                    
                    return {
                        success: true,
                        type: 'floating-window',
                        features: ['draggable', 'resizable', 'floating'],
                        module: 'FloatingWindowModule'
                    };
                } catch (error) {
                    throw new Error(`Floating Window: ${error.message}`);
                }
            }
            
            makeDraggable(element) {
                let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                element.onmousedown = dragMouseDown;
                
                function dragMouseDown(e) {
                    e = e || window.event;
                    e.preventDefault();
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                    document.onmouseup = closeDragElement;
                    document.onmousemove = elementDrag;
                }
                
                function elementDrag(e) {
                    e = e || window.event;
                    e.preventDefault();
                    pos1 = pos3 - e.clientX;
                    pos2 = pos4 - e.clientY;
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                    element.style.top = (element.offsetTop - pos2) + "px";
                    element.style.left = (element.offsetLeft - pos1) + "px";
                }
                
                function closeDragElement() {
                    document.onmouseup = null;
                    document.onmousemove = null;
                }
            }
            
            // –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –ú–û–î–£–õ–¨–ù–û–°–¢–ò, –ö–û–ú–ú–£–ù–ò–ö–ê–¶–ò–ò –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
            async testModularity(architecture, method) {
                // –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤—Å–µ 12 –º–µ—Ç–æ–¥–æ–≤ –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
                await this.delay(1000);
                return { 
                    success: Math.random() > 0.4,
                    method,
                    details: `–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å ${method} –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ ${architecture}`
                };
            }
            
            async testCommunication(architecture, method) {
                // –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤—Å–µ 8 –º–µ—Ç–æ–¥–æ–≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
                await this.delay(1000);
                return { 
                    success: Math.random() > 0.3,
                    method,
                    details: `–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è ${method} –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ ${architecture}`
                };
            }
            
            async testSecurity(architecture, test) {
                // –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤—Å–µ 6 —Ç–µ—Å—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
                await this.delay(1000);
                return { 
                    success: Math.random() > 0.2,
                    test,
                    details: `–¢–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ${test} –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ ${architecture}`
                };
            }
            
            // UI –º–µ—Ç–æ–¥—ã
            updateProgress() {
                const progress = (this.currentTestIndex / this.totalTests) * 100;
                const progressFill = document.getElementById('progressFill');
                const overallProgress = document.getElementById('overallProgress');
                
                progressFill.style.width = `${progress}%`;
                overallProgress.textContent = `${progress.toFixed(1)}%`;
                
                // –í—Ä–µ–º—è
                const elapsed = Date.now() - this.startTime;
                document.getElementById('elapsedTime').textContent = this.formatTime(elapsed);
                
                if (progress > 0) {
                    const remaining = (elapsed / progress) * (100 - progress);
                    document.getElementById('remainingTime').textContent = this.formatTime(remaining);
                }
            }
            
            updateCurrentTestDisplay(test) {
                document.getElementById('currentTestName').textContent = test.combo;
                document.getElementById('comboChain').innerHTML = `
                    <div>üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: ${test.arch}</div>
                    <div>üîß –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å: ${test.modularity}</div>
                    <div>üì° –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è: ${test.communication}</div>
                    <div>üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: ${test.security}</div>
                `;
            }
            
            addTestCard(testResult) {
                const card = document.createElement('div');
                card.className = `test-card pending`;
                card.id = `test-${testResult.id}`;
                card.innerHTML = `
                    <div class="test-header">
                        <div class="test-name">${testResult.combo}</div>
                        <div class="test-status status-pending">‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ</div>
                    </div>
                    <div class="test-details">
                        <div>–ó–∞–ø—É—Å–∫: ${testResult.startTime.toLocaleTimeString()}</div>
                        <div>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: -</div>
                    </div>
                `;
                this.resultsGrid.appendChild(card);
            }
            
            updateTestCard(testResult) {
                const card = document.getElementById(`test-${testResult.id}`);
                if (!card) return;
                
                const statusClass = testResult.status === 'success' ? 'success' : 'failed';
                const statusText = testResult.status === 'success' ? '‚úÖ –£—Å–ø–µ—Ö' : '‚ùå –û—à–∏–±–∫–∞';
                const statusColor = testResult.status === 'success' ? 'status-success' : 'status-failed';
                
                card.className = `test-card ${statusClass}`;
                card.querySelector('.test-status').className = `test-status ${statusColor}`;
                card.querySelector('.test-status').textContent = statusText;
                
                const details = card.querySelector('.test-details');
                details.innerHTML = `
                    <div>–ó–∞–ø—É—Å–∫: ${testResult.startTime.toLocaleTimeString()}</div>
                    <div>–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ: ${testResult.endTime.toLocaleTimeString()}</div>
                    <div>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${testResult.duration}ms</div>
                    ${testResult.error ? `<div style="color: #dc3545; margin-top: 8px;">${testResult.error}</div>` : ''}
                `;
            }
            
            log(message, type = 'info') {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = `
                    <span class="log-timestamp">[${timestamp}]</span>
                    <span class="log-${type}">${message}</span>
                `;
                
                this.logsContainer.appendChild(logEntry);
                this.logsContainer.scrollTop = this.logsContainer.scrollHeight;
            }
            
            finishTesting() {
                this.isTesting = false;
                this.startButton.disabled = false;
                this.stopButton.disabled = true;
                this.reloadButton.disabled = false;
                this.exportButton.disabled = false;
                this.startButton.querySelector('.spinner').classList.add('hidden');
                this.cleanupNotice.classList.remove('hidden');
                
                this.showSummary();
                this.log('üéâ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!', 'success');
                this.log('‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤', 'warning');
            }
            
            stopTesting() {
                this.isTesting = false;
                this.startButton.disabled = false;
                this.stopButton.disabled = true;
                this.reloadButton.disabled = false;
                this.startButton.querySelector('.spinner').classList.add('hidden');
                this.cleanupNotice.classList.remove('hidden');
                
                this.log('‚èπÔ∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º', 'warning');
            }
            
            reloadPage() {
                if (confirm('–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É? –í—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç –æ—á–∏—â–µ–Ω—ã.')) {
                    location.reload();
                }
            }
            
            showSummary() {
                const successfulTests = Array.from(this.results.values()).filter(r => r.status === 'success').length;
                const failedTests = Array.from(this.results.values()).filter(r => r.status === 'failed').length;
                const successRate = (successfulTests / this.totalTests) * 100;
                
                this.summarySection.classList.remove('hidden');
                
                document.getElementById('statsContainer').innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number stat-success">${successfulTests}</div>
                        <div>–£—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number stat-failed">${failedTests}</div>
                        <div>–ù–µ—É–¥–∞—á–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${this.totalTests}</div>
                        <div>–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #007bff;">${successRate.toFixed(1)}%</div>
                        <div>–£—Å–ø–µ—à–Ω–æ—Å—Ç—å</div>
                    </div>
                `;
                
                this.generateRecommendations();
            }
            
            generateRecommendations() {
                const workingCombinations = Array.from(this.results.values())
                    .filter(r => r.status === 'success')
                    .map(r => r.combo);
                
                let recommendationsHTML = '<h3>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:</h3>';
                
                if (workingCombinations.length > 0) {
                    recommendationsHTML += `
                        <div class="recommendation-item">
                            <strong>‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (–ø–µ—Ä–≤—ã–µ 5):</strong>
                            <ul>
                                ${workingCombinations.slice(0, 5).map(combo => `<li>${combo}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
                
                recommendationsHTML += `
                    <div class="recommendation-item">
                        <strong>üèóÔ∏è –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:</strong>
                        <p>–ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å iframe-based —Ä–µ—à–µ–Ω–∏—è —Å blob-url –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å—é</p>
                    </div>
                    <div class="recommendation-item">
                        <strong>üîß –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:</strong>
                        <p>Blob URL –∏ Data URL –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ª—É—á—à—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å CSP</p>
                    </div>
                    <div class="recommendation-item">
                        <strong>üì° –ù–∞–¥–µ–∂–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è:</strong>
                        <p>PostMessage –∏ Custom Events —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –æ–∫—Ä—É–∂–µ–Ω–∏–π</p>
                    </div>
                `;
                
                document.getElementById('recommendationsContainer').innerHTML = recommendationsHTML;
            }
            
            exportResults() {
                const resultsData = {
                    timestamp: new Date().toISOString(),
                    context: this.currentContext,
                    totalTests: this.totalTests,
                    successfulTests: Array.from(this.results.values()).filter(r => r.status === 'success').length,
                    results: Array.from(this.results.entries())
                };
                
                const dataStr = JSON.stringify(resultsData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `extension-architecture-test-${new Date().toISOString().slice(0, 19)}.json`;
                link.click();
                
                this.log('üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
            }
            
            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
            
            formatTime(ms) {
                const seconds = Math.floor(ms / 1000);
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            window.extensionTest = new CascadedExtensionArchitectureTest();
        });
    </script>
</body>
</html>